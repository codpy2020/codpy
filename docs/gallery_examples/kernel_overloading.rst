
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery_examples\kernel_overloading.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_examples_kernel_overloading.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_examples_kernel_overloading.py:


Kernel Overloading Example
==========================

This example demonstrates kernel overloading using CodPy.

.. GENERATED FROM PYTHON SOURCE LINES 7-39

.. code-block:: Python


    # import libraries
    import numpy as np
    from codpydll import *

    import codpy.core as core


    # define the class
    class my_kernel(core.cd.kernel):
        # An example of overloading codpy kernel with a user-defined expression.

        def __init__(self, **kwargs):
            core.cd.kernel.__init__(self)
            self.bandwidth_ = float(kwargs.get("bandwidth", 1.0))

        @staticmethod
        def create(kwargs={}):
            return my_kernel(**kwargs)

        @staticmethod
        def register():
            cd.kernel.register("my_kernel", my_kernel.create)

        def k(self, x, y):
            out = np.linalg.norm((x - y) * self.bandwidth_)
            return out * out * 0.5

        def grad(self, x, y):
            return y * self.bandwidth_









.. GENERATED FROM PYTHON SOURCE LINES 40-41

Generate data for the kernel.

.. GENERATED FROM PYTHON SOURCE LINES 43-45

.. code-block:: Python

    x, y = np.random.randn(3, 2), np.random.randn(3, 2)








.. GENERATED FROM PYTHON SOURCE LINES 46-47

Create a kernel object and display the result.

.. GENERATED FROM PYTHON SOURCE LINES 49-53

.. code-block:: Python

    my_kernel_ = my_kernel.create()
    result_1 = my_kernel_.k(x[0], y[0])
    print("Result 1:", result_1)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Result 1: 0.5353263912941348




.. GENERATED FROM PYTHON SOURCE LINES 54-55

Set the kernel and display the next result.

.. GENERATED FROM PYTHON SOURCE LINES 57-62

.. code-block:: Python

    my_kernel.set_kernel_ptr(my_kernel_)
    my_kernel_ptr = core.kernel_interface.get_kernel_ptr()
    result_2 = my_kernel_.k(x[0], y[0])
    print("Result 2:", result_2)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Result 2: 0.5353263912941348




.. GENERATED FROM PYTHON SOURCE LINES 63-64

Compute the Gram matrix and display it.

.. GENERATED FROM PYTHON SOURCE LINES 66-69

.. code-block:: Python

    gram_matrix = core.op.Knm(x, y)
    print("Gram Matrix:", gram_matrix)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Gram Matrix: [[0.53532639 0.84452703 1.01404385]
     [0.40688305 1.05464043 0.40891759]
     [0.4455739  0.67120444 0.7541678 ]]




.. GENERATED FROM PYTHON SOURCE LINES 70-71

Register the kernel (no output for this step).

.. GENERATED FROM PYTHON SOURCE LINES 73-81

.. code-block:: Python

    my_kernel.register()
    my_kernel_ptr = core.factories.get_kernel_factory()["my_kernel"]({"bandwidth": "2."})


    # !!!!!!!! a corriger
    # print(my_kernel_ptr.k(x[0], y[0]))
    # my_kernel.set_kernel_ptr(my_kernel_ptr)
    # print(core.op.Knm(x, y))








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.509 seconds)


.. _sphx_glr_download_gallery_examples_kernel_overloading.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: kernel_overloading.ipynb <kernel_overloading.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: kernel_overloading.py <kernel_overloading.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: kernel_overloading.zip <kernel_overloading.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
